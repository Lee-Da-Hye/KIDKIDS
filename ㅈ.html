<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>대한민국 미세먼지 측정 정보</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

<div id="dust">
    <h1>대한민국 미세먼지 측정 정보</h1>
    <div id="dustStatus">
        <h2 id="location">위치를 가져오는 중...</h2>
        <p id="pm10StatusText">미세먼지(PM10) 농도: </p>
        <p id="pm25StatusText">초미세먼지(PM2.5) 농도: </p>
    </div>
</div>

<script>
// API 키
var apiKey = 'LukiVznMrRVfgr%2FmME%2Flropqo%2Fn39Hq74bNK9gZh1%2B8oW%2BLAi70wMvDqzgXK3cAyZzlWSKjieh68kBnwM8TQoQ%3D%3D';

// 대기오염 정보를 가져오는 함수
function getAirPollutionInfo() {
    // API 호출
    var apiUrl = `https://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getCtprvnRltmMesureDnsty?serviceKey=${apiKey}&returnType=json&numOfRows=100&pageNo=1&sidoName=%EC%84%9C%EC%9A%B8&ver=1.0`;
    
    $.ajax({
        url: apiUrl,
        method: 'GET',
        data: {
            serviceKey: apiKey,
            pageNo: 1,
            numOfRows: 1,
            sidoName: '경기', // 원하는 도시명 입력
            searchCondition: 'DAILY',
            _returnType: 'json' // JSON 응답을 요청
        },
        dataType: 'json', // dataType을 JSON으로 설정
        success: function(data) {
            var items = data.response.body.items;
            var pm10Value = items[0].pm10Value;
            var o3Value = items[0].o3Value;
            updateAirPollutionInfo('서울', pm10Value, o3Value);
        },
        error: function(xhr, status, error) {
            console.error('API 요청 실패:', status, error);
            // 실패 시 에러 메시지를 화면에 표시
            updateAirPollutionInfo('정보를 가져올 수 없음', 'N/A', 'N/A');
        }
    });
}

// 대기오염 정보를 업데이트하여 화면에 표시하는 함수
function updateAirPollutionInfo(location, pm10Value, o3Value) {
    document.getElementById('location').textContent = location;
    document.getElementById('pm10StatusText').textContent = '미세먼지(PM10) 농도: ' + pm10Value;
    document.getElementById('pm25StatusText').textContent = '오존 농도: ' + o3Value;
}

// 페이지 로드 시 대기오염 정보 가져오기
$(document).ready(function() {
    getAirPollutionInfo();
});
// 등급에 따른 이미지 경로 설정
var imagePaths = {
    'good': '/img/good.png',
    'normal': '/img/normal.png',
    'bad': '/img/bad.png',
    'verybad': '/img/verybad.png'
};

// 미세먼지 상태 이미지 업데이트 함수
function updateDustImage(status) {
    var imagePath = imagePaths[status];
    $('#dustImage').attr('src', imagePath);
}

// 오존 상태 이미지 업데이트 함수
function updateOzoneImage(status) {
    var imagePath = imagePaths[status];
    $('#ozoneImage').attr('src', imagePath);
}

// 서버로부터 받은 미세먼지 및 오존 상태에 따라 이미지 업데이트
function updateImages(dustStatus, ozoneStatus) {
    updateDustImage(dustStatus);
    updateOzoneImage(ozoneStatus);
}
success: function(json) {
    // 미세먼지 및 오존 상태에 따른 이미지 업데이트
    updateImages(json[1], json[2]);

    // 미세먼지 및 오존 상태에 따른 텍스트 업데이트
    updateText(json[1], json[2]);
}



</script>

</body>
</html>
